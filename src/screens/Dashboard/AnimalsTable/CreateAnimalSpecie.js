import React, { Component } from 'react';
// import { Row, Col } from 'react-bootstrap';
import { connect } from 'react-redux';
import TextField from '../../../components/TextField/TextField';
import Button from '../../../components/Button/Button';
import { createAnimalSpecie } from '../../../actions/animalSpecieActions';
import AvatarUpload from '../../../components/AvatarUpload/AvatarUpload';

class CreateAnimalSpecie extends Component {
  constructor() {
    super();
    this.state = {
      name: '',
      disabled: true,
      openToolTip: false,
      toolTipMsg: '',
      preview: null,
      src: ''
    };
  }

  onClose = () => {
    this.setState({ preview: null });
  };

  onCrop = preview => {
    this.setState({ preview });
  };

  checkDisabled = e => {
    this.setState({ name: e.target.value });
    if (e.target.value === '') {
      this.setState({ disabled: true });
    } else {
      this.setState({ disabled: false });
    }
  };

  callBack = APIresponse =>
    this.setState({ openToolTip: true, toolTipMsg: APIresponse.message });
  createAnimalSpecie = () => {
    this.props.dispatch(
      createAnimalSpecie(
        { name: this.state.name, image: this.state.preview },
        this.callBack
      )
    );
  };

  render() {
    const { disabled, openToolTip, toolTipMsg } = this.state;
    return (
      <div>
        <form>
          <div
            style={{
              width: '62%',
              margin: '1em auto',
              marginTop: '0',
              marginBottom: '0'
            }}
          >
            <div>
              <TextField
                label="New Animal Name"
                onChange={this.checkDisabled}
              />
            </div>
            <div>
              <AvatarUpload
                onCrop={this.onCrop}
                onClose={this.onClose}
                src={this.state.src}
                preview={this.state.preview}
              />
            </div>
            {openToolTip ? <p style={{ color: 'green' }}>{toolTipMsg}</p> : ''}
            <div style={{ marginLeft: '55vh' }}>
              <Button
                value="create animal"
                disabled={disabled}
                onClick={this.createAnimalSpecie}
              />
            </div>
          </div>
        </form>
      </div>
    );
  }
}

export default connect()(CreateAnimalSpecie);
