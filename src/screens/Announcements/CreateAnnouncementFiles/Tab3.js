import React, { Component } from 'react';
import { cloneDeep } from 'lodash';
import ReactSelect from '../../../components/Dropdown/ReactSelect';
import TextField from '../../../components/TextField/TextField';

class Tab3 extends Component {
  constructor() {
    super();
    this.state = {
      globalMethodsCart: [
        {
          selectedMethod: {},
          method: '',
          min: '',
          max: '',
          units: '',
          material: ''
        }
      ]
    };
  }

  incrementCart = () => {
    const { globalMethodsCart } = this.state;
    const globalMethodsCartClone = cloneDeep(globalMethodsCart);
    globalMethodsCartClone.push({
      selectedMethod: {},
      method: '',
      min: '',
      max: '',
      units: '',
      material: ''
    });
    this.setState({ globalMethodsCart: globalMethodsCartClone });
  };

  selectedMethod = (e, i) => {
    const { globalMethodsCart } = this.state;
    globalMethodsCart.map((row, index) => {
      if (index === i) {
        // eslint-disable-next-line
        row.selectedMethod = e;
        // eslint-disable-next-line
        row.method = e.value;
      }
      return null;
    });
    this.setState({ globalMethodsCart });
  };

  textOnChange = (e, count) => {
    const { globalMethodsCart } = this.state;
    globalMethodsCart.map((values, index) => {
      if (index === count) {
        if (e.target.type === 'number') {
          // eslint-disable-next-line
          values[e.target.name] = Number(e.target.value);
        } else {
          // eslint-disable-next-line
          values[e.target.name] = e.target.value;
        }
      }
      return null;
    });
    this.setState({ globalMethodsCart });
  };

  render() {
    const { globalMethodsCart } = this.state;
    return (
      <div>
        <div>
          <i
            className="far fa-plus-square addIcon"
            title="Add"
            onClick={this.incrementCart}
          />
        </div>
        <div>
          {globalMethodsCart.map((row, index) => (
            <div>
              <div>
                <ReactSelect
                  options={[
                    { value: 'Inject', label: 'Inject' },
                    { value: 'Extract', label: 'Extract' }
                  ]}
                  value={row.selectedMethod}
                  onChange={e => this.selectedMethod(e, index)}
                />
              </div>
              <div>
                <TextField
                  type="number"
                  value={row.min}
                  name="min"
                  label="Minium"
                  onChange={e => this.textOnChange(e, index)}
                />
              </div>
              <div>
                <TextField
                  type="number"
                  value={row.max}
                  name="max"
                  label="Maximum"
                  onChange={e => this.textOnChange(e, index)}
                />
              </div>
              <div>
                <TextField
                  type="number"
                  value={row.units}
                  name="units"
                  label="Units"
                  onChange={e => this.textOnChange(e, index)}
                />
              </div>
              <div>
                <TextField
                  type="number"
                  value={row.material}
                  name="material"
                  label="Material"
                  onChange={e => this.textOnChange(e, index)}
                />
              </div>
            </div>
          ))}
        </div>
      </div>
    );
  }
}

export default Tab3;
