import React, { Component } from 'react';
import { connect } from 'react-redux';
import { announcementTableColumns } from '../Dashboard/TableColumns';
import CheckBoxTable from '../../components/Table/CheckboxTable';

class AnnouncementsTableView extends Component {
  getSelectedRowData = (selection, announcements) => {
    const objectId = '_id';
    let selectedRowObj = {};
    announcements.map(anncmnts => {
      if (selection.indexOf(anncmnts[objectId]) >= 0) {
        selectedRowObj = anncmnts;
      }
      return null;
    });
    return selectedRowObj;
  };

  toggleSelection = (selectedId, announcements) => {
    const selectedRowDataObj = this.getSelectedRowData(
      selectedId,
      announcements
    );
    let createdCartData = [{}];
    let createdAttributesData = [{}];
    if (selectedRowDataObj.animals) {
      createdCartData = selectedRowDataObj.animals;
    }
    if (selectedRowDataObj.attributes) {
      createdAttributesData = selectedRowDataObj.attributes;
    }
    this.props.changeParentState({
      selection: selectedId,
      cartData: createdCartData,
      attributesCart: createdAttributesData,
      announcementName: selectedRowDataObj.name,
      selectedStatusOnEdit: {
        value: selectedRowDataObj.status,
        label: selectedRowDataObj.status
      },
      selectedRowData: selectedRowDataObj
    });
  };

  render() {
    const { announcements } = this.props;
    return (
      <div>
        <div>
          <CheckBoxTable
            toggleSelection={selection =>
              this.toggleSelection(selection, announcements)
            }
            toggleAll={(selectAll, selection) =>
              this.props.changeParentState({ selectAll, selection })
            }
            selection={this.props.selection}
            selectAll={this.props.selectAll}
            data={announcements}
            columns={announcementTableColumns}
          />
        </div>
      </div>
    );
  }
}

export default connect()(AnnouncementsTableView);
