import { API_POST, API_PUT } from './APIMethods';
import {
  AnimalSpecieType,
  AnimalsType,
  // AnimalGroupType,
  ErrorType
} from './ActionType';
import { AnimalSpecieUrl, OrderAnimalUrl, StudyUrl } from './ActionURL';

export const createAnimalSpecie = (specieObj, callBack) => {
  const url = `${AnimalSpecieUrl.CREATE_ANIMALSPECIE}`;
  return async dispatch => {
    try {
      const result = await API_POST(url, specieObj);
      if (!result.error) {
        dispatch({
          type: AnimalSpecieType.CREATE_ANIMALSPECIE,
          payload: result
        });
      }
      callBack(result);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};

export const submitOrder = (orderDetails, callBack) => {
  const url = `${OrderAnimalUrl.ORDER_ANIMALS}`;
  return async dispatch => {
    try {
      const result = await API_POST(url, orderDetails);
      if (!result.error) {
        dispatch({
          type: AnimalsType.FETCHED_ANIMALS,
          payload: result.data
        });
      }
      callBack(result);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};

export const createStudy = (studyDetails, callBack) => {
  const url = `${StudyUrl.CREATE_STUDY}`;
  return async dispatch => {
    try {
      const result = await API_POST(url, studyDetails);
      if (!result.error) {
        dispatch({
          // type: AnimalGroupType.CREATE_STUDY,
          type: AnimalsType.FETCHED_ANIMALS,
          payload: result.data
        });
      }
      callBack(result.message);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};

export const submitStudyResultToDB = (studyResult, callBack) => {
  const url = `${StudyUrl.SUBMIT_STUDY_RESULT}`;
  return async dispatch => {
    try {
      const result = await API_POST(url, studyResult);
      console.log('result on study result', result);
      if (!result.error) {
        dispatch({
          type: AnimalsType.FETCHED_ANIMALS,
          payload: result.data
        });
      }
      callBack(result);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};

export const updateAnimalData = (data, id, callBack) => {
  const url = `${OrderAnimalUrl.UPDATE_ANIMALS_DATA}/${id}`;
  return async dispatch => {
    try {
      const result = await API_PUT(url, data);
      if (!result.error) {
        dispatch({
          type: AnimalsType.UPDATED_ANIMALS_DATA,
          payload: result.data
        });
      }
      callBack(result);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};

export const createAnimalsData = (data) => {
  const url = `${OrderAnimalUrl.CREATE_ANIMALS_DATA}`;
  console.log(data);
  return async dispatch => {
    try {
      const result = await API_POST(url, data);
      console.log(result);
      // if (!result.error) {
      //   dispatch({
      //     type: AnimalsType.UPDATED_ANIMALS_DATA,
      //     payload: result.data
      //   });
      // }
      // callBack(result);
    } catch (error) {
      dispatch({ type: ErrorType.ERROR_LOG, message: error.message });
    }
  };
};
